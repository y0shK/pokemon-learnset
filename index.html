<!DOCTYPE html>

<html lang="en">

    <head>

        <meta charset="UTF-8">

        <link rel="stylesheet" href="style.css">

    </head>

    <title> Pokemon Learnset Resource </title>

    <body>

    <h1> Pokemon Learnsets by Generation </h1>

    <p> What Pokemon do you want the learnset for? </p>

    <!-- make sure that there is some pokemon entered, because it's necessary for the app functionality-->
    <!-- ask if the user cares about a specific generation
    if yes, direct to the specific generation, else direct to general page -->
    <!-- on keyup, if the text box is blank, then ensure that the user provides proper input -->

    <input type="text" id="pokemon" onkeyup="verifyPokemon()"> <!-- input pokemon's name -->

    <p id="userPrompt"> <br> </p>

    <!--execute prompt for better input
        if the box is typed in but left blank, then prompt the user
        else, simply type the answer-->
    <script>
        function verifyPokemon() {
            var pokemon_provided = document.getElementById("pokemon").value;
            //document.getElementById("userPrompt").textContent = pokemon_provided;
            if (!pokemon_provided) {
                document.getElementById("userPrompt").textContent = "Please enter a Pokemon!";
            }
            //else {
              //  document.getElementById("userPrompt").textContent = pokemon_provided;
            //}

    }
    </script>

    <br>

    <!-- ask if the user needs a learnset for a specific generation or just wants general info
         if general info, point to veekun
         else, point to pokemondb
    -->

    <!-- create radio buttons to decide
        the name needs to be mutually exclusive so that the radio buttons are mutually exclusive
         https://stackoverflow.com/questions/3216512/how-can-i-create-mutually-exclusive-radio-buttons-with-different-names
         -->
    <p>Pokedex entry or specific generation learnset?</p>
    <input type="radio" name="functionality" id="pokedex" value="Pokedex entry">
    <label for="pokedex">Pokedex entry</label><br>
    <input type="radio" name="functionality" id="learnset" value="specific learnset">
    <label for="learnset">specific learnset</label><br>

    <br>

    <!-- if pokedex indicated, simply redirect to veekun
        ask what generation only if it's indicated
        https://stackoverflow.com/questions/35202952/text-box-to-appear-when-a-radio-button-is-selected
        -->

    <!-- take care of generation only if indicated
        do so with a text box that appears only when the generation radio button is checked
         https://stackoverflow.com/questions/35202952/text-box-to-appear-when-a-radio-button-is-selected -->
    <div id="dvtext">
        Which generation?
        <input type="text" id="generation">
    </div>

    <p id="output_pokemon"></p>
    <p id="output_generation"></p>

    <!-- w3schools.com -->
    <script>
        function getPokemon() {
            var pokemon = document.getElementById("pokemon").value;
            return pokemon;
    }
    getPokemon();
    </script>

    <!-- similar script for generations-->

    <script>
        function getGeneration() {
            var generation = document.getElementById("generation").value;
            return generation
    }
    getGeneration();
    </script>

    <!-- if Enter is pressed in the text box, obtain the output value -->
    <!-- https://www.w3schools.com/howto/howto_js_trigger_button_enter.asp -->
    <script>
        // Get the input field
        var input = document.getElementById("pokemon");

        // Execute a function when the user releases a key on the keyboard
        input.addEventListener("keyup", function(event) {

        // Number 13 is the "Enter" key on the keyboard
        if (event.keyCode === 13) {
            // Cancel the default action, if needed
            event.preventDefault();
            // Trigger the button element with a click
            document.getElementById("button_pokemon").click();
            }
        });
    </script>

    <!-- same script for generation text box -->
    <script>
        // Get the input field
        var input = document.getElementById("generation");

        // Execute a function when the user releases a key on the keyboard
        input.addEventListener("keyup", function(event) {

        // Number 13 is the "Enter" key on the keyboard
        if (event.keyCode === 13) {
            // Cancel the default action, if needed
            event.preventDefault();
            // Trigger the button element with a click
            document.getElementById("button_generation").click();
            }
        });
    </script>

    <button onclick=redirectPage()> redirect </button>

    <p id="testPokemon"></p>

    <!-- take the base pokemondb link and concat a new url depending on given pokemon and generation -->
    <script>
        function redirectPage() {
            // (if pokemon) is false if string is empty and true if string is not empty
            // similarly, (if generation) will be false if no integer is provided (or 0)

            pokemon = getPokemon()
            generation = getGeneration()

            // error checking for pokemon and generation

            var pokemonIsString;
            var generationIsIntForm;

            // check if pokemon provided is a string - this is the only acceptable form
            // however, it needs to be a genuine string, not just an integer of type Str (e.g. 'two', not '2')
            // do this by checking whether the pokemon input can be parsed to int - if it can, it's not appropriate input

            // https://stackoverflow.com/questions/6466709/check-whether-a-textbox-value-is-numeric-or-string
            if (isNaN(parseInt(pokemon))) { // 'two' cannot be parsed to integer
                pokemonIsString = true;
            }
            else { // '2' can be parsed to integer - this is not the input we want
                pokemonIsString = false;
            }

            // check if generation provided is either an integer (e.g. 4) or roman numeral ('IV')
            let generationRomanNums = ['i', 'ii', 'iii', 'iv', 'v', 'vi', 'vii', 'viii'];
            let generationNums = [1, 2, 3, 4, 5, 6, 7, 8];

            if (Number.isInteger(generation) && generation in generationNums) {
                generationIsIntForm = true;
            }
            else if (generation in generationRomanNums) { // if the roman numeral is provided

                generationIsIntForm = true;

                for (i = 0; i < generationRomanNums.length; i++) { // iterate through the roman numeral array
                    if (generation.toLowerCase() == generationRomanNums[i]) { // if we find a match
                        generation = String(generationNums[i]); // redefine generation as integer, but as type String
                        break;
                    }
                }

            }
            //else { // generation != 1, 2, ... and generation != 'i', 'ii', ..., so it's not integer form
              //  generationIsIntForm = false;
            //}

            // if pokemon and generation are provided, then link to pokemondb
            // if pokemon and pokedex entry are provided, then it depends
                // link to veekun for gen 1-7
                // link to marriland pokedex for gen 8

            var pokedexEntryBool = document.getElementById("pokedex").checked;
            var learnsetBool = document.getElementById("learnset").checked;

            // flowchart for different functionality

            // if pokemon provided, learnset button checked, and generation provided
            // & error checking
            if (pokemonIsString && generationIsIntForm && learnsetBool) { // pokemondb

                var base_url = "https://pokemondb.net/pokedex/";

                pokemon = pokemon.toLowerCase();
                generation = String(generation);

                pokemon_url = base_url.concat(pokemon);
                pokemon_url = pokemon_url.concat("/moves/");

                whole_url = pokemon_url.concat(generation);

                window.location.href = whole_url;
            }
            // if pokemon provided and pokedex entry checked
            else if (pokemon && pokedexEntryBool) { // veekun

                var base_url = "https://veekun.com/dex/pokemon/"

                pokemon = getPokemon().toLowerCase();

                whole_url = base_url.concat(pokemon);
                window.location.href = whole_url;
            }
        }

    </script>

    </body>

</html>